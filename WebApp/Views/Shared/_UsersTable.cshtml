@model IEnumerable<WebApp.Models.UserModel.UserViewModel>

@{
    var currentPage = Convert.ToInt32(ViewData["CurrentPage"] ?? 1);
}

<ul class="list-group">
    @if (Model == null || !Model.Any())
    {
        <li class="list-group-item text-center">No users found.</li>
    }
    else
    {
        <table class="table table-striped align-middle">
            <thead>
                <tr class="text-center">
                    <th>Name</th>
                    <th>Transaction Count</th>
                    <th>Total Income</th>
                    <th>Total Expense</th>
                    <th>Last Transaction Date</th>
                </tr>
            </thead>
        @foreach (var user in Model)
        {
           <tbody>
                <tr class="text-center">
                    <td class="align-middle">
                        @user.UserName
                    </td>
                    <td class="align-middle">
                        @user.TransactionCount
                    </td>
                    <td class="align-middle">
                        @user.TotalIncome
                    </td>
                    <td class="align-middle">
                        @user.TotalExpense
                    </td>
                    <td class="align-middle">
                        @(user.LastTransactionDate?.ToString("yyyy-MM-dd") ?? "")
                    </td>
                    <td>
                        <div>
                            <a href="@Url.Action("Details", "User", new { id = user.UserId , currentPage = currentPage})" class="btn btn-sm btn-info">
                                <i class="bi bi-info-circle"></i> 
                            </a>
                            <form asp-action="Delete" asp-controller="User" asp-route-currentPage = "@currentPage" asp-route-id="@user.UserId" 
                                    method="post" class="d-inline" 
                                    onsubmit="return confirm('Are you sure you want to delete this user?');">
                                <button type="submit" class="btn btn-sm btn-danger">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
            </tbody>
        }
        </table>
    }
</ul>